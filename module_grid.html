

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Grid &mdash; fretraj  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cloud" href="module_cloud.html" />
    <link rel="prev" title="PyMOL Plugin" href="pymol_plugin.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #333" >
          

          
            <a href="index.html" class="icon icon-home"> fretraj
          

          
            
            <img src="_static/fretraj_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="accessible_volume.html">The accessible volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact_volume.html">Dye interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter_file.html">The parameter file</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pymol_plugin.html">PyMOL Plugin</a></li>
</ul>
<p class="caption"><span class="caption-text">Code</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Grid</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="module_cloud.html">Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_fret.html">FRET</a></li>
<li class="toctree-l1"><a class="reference internal" href="module_utilities.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="references.html">Publications and related projects</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">fretraj</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Grid</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/module_grid.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="grid">
<h1>Grid<a class="headerlink" href="#grid" title="Permalink to this headline">¶</a></h1>
<p>The <strong>grid</strong> submodule generates a ACV point cloud using Python-only functions. While naturally slower than the C++ version implemented in LabelLib it allows for rapid prototyping.</p>
<div class="toctree-wrapper compound">
</div>
<span class="target" id="module-fretraj.grid"></span><dl class="py class">
<dt id="fretraj.grid.Grid3D">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">fretraj.grid.</span></code><code class="sig-name descname"><span class="pre">Grid3D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attach_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linker_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linker_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dye_radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_spacing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simulation_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class object holding a 3D grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_xyzr</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>attach_xyz</strong> (<em>ndarray</em>) – one-dimensional array of x-,y-,z-coordinates of the attachment point
(corresponds to the center of the grid)</p></li>
<li><p><strong>linker_length</strong> (<em>float</em>) – length of the dye linker in Angstrom</p></li>
<li><p><strong>linker_width</strong> (<em>float</em>) – diameter of the dye linker in Angstrom</p></li>
<li><p><strong>dye_radii</strong> (<em>ndarray([3,1])</em>) – array of dye radii in Angstrom with shape [3,1]</p></li>
<li><p><strong>grid_spacing</strong></p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>discStep</strong> (<em>-</em>) – </p></li>
<li><p><strong>originXYZ</strong> (<em>-</em>) – </p></li>
<li><p><strong>shape</strong> (<em>-</em>) – </p></li>
<li><p><a class="reference internal" href="#module-fretraj.grid" title="fretraj.grid"><strong>grid</strong></a> (<em>-</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="fretraj.grid.Grid3D.addWeights">
<code class="sig-name descname"><span class="pre">addWeights</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">das_xyzrm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.addWeights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.addWeights" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign a weight to the grid values which are part of the contact volume</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>das_xyzrm</strong> (<em>numpy.ndarray([5,n_atoms])</em>) – array of marked coordinates and padded vdW radii (n_atoms = number of atoms in mdtraj.Trajectory)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_3d</strong> (<em>numpy.ndarray([nx,ny,nz])</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.block_molecule">
<code class="sig-name descname"><span class="pre">block_molecule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extraClash</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.block_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.block_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Block the grid points which are within the VdW radius of any atom of the biomolecule plus an extra clash radius</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_xyzr</strong> (<em>ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>extraClash</strong> (<em>float</em>) – clash radius added to the VdW radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape of 2*adjL+1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.dijkstra">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">dijkstra</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges_ess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edges_src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority_queue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_ijk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.dijkstra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.dijkstra" title="Permalink to this definition">¶</a></dt>
<dd><p>Djikstra algorithm with a priority queue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>numpy.ndarray</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p></li>
<li><p><strong>edges_ess</strong> (<em>nb.typed.List of 2-tuples of numpy.ndarray and float</em>) – list n essential neighbors from the origin (0,0,0)</p></li>
<li><p><strong>edges_src</strong> (<em>list of 2-tuples of numpy.ndarray and float</em>) – nb.typed.List of neighbors in the initialization round of the Dijkstra algorithm</p></li>
<li><p><strong>priority_queue</strong> (<em>list of 2-tuples of numpy.ndarray and float</em>) – list with distance and index of origin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_3d</strong> (<em>numpy.ndarray([nx,ny,nz])</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.dijkstra_init">
<code class="sig-name descname"><span class="pre">dijkstra_init</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxR_source</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.dijkstra_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.dijkstra_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the Dijkstra search algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxR</strong> (<em>float</em>) – radius within to search for neighbors</p></li>
<li><p><strong>maxRsource</strong> (<em>float</em>) – radius within to search for neighbors in the first round of the Dijkstra algorithm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape of 2*adjL+1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.essential_neighbors">
<code class="sig-name descname"><span class="pre">essential_neighbors</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.essential_neighbors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.essential_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the neighbor list to those indices with a distance from the origin featured in dist_list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idxs</strong> (<em>list of 2-tuples of numpy.ndarray and float</em>) – the tuples contain the ijk indices and the distance from the origin (0,0,0)</p></li>
<li><p><strong>idxs_ess</strong> (<em>list of 2-tuples of numpy.ndarray and float</em>) – list n essential neighbors from the origin (0,0,0)</p></li>
</ul>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>If dist_list=sqrt([1, 2, 3, 5, 6]) then the the neighbor list is reduced to 74 neighbors
which make up a spherical shape and are a good compromise between neighbor space and time efficiency
in the Dijkstra algorithm. The smaller this list the faster the Dijkstra algorithm will run
at the expense of the accuracy of the resulting accessible volume (i.e. its “sphericalness”)</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.excludeConcentricSpheres">
<code class="sig-name descname"><span class="pre">excludeConcentricSpheres</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol_xyzr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dye_radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxRho</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.excludeConcentricSpheres"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.excludeConcentricSpheres" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_xyzr</strong> (<em>numpy.ndarray</em>) – array of x-,y-,z-coordinates and VdW radii with a shape [n_atoms, 4]</p></li>
<li><p><strong>dye_radii</strong> (<em>ndarray([3,1])</em>) – array of dye radii in Angstrom with shape [3,1]</p></li>
<li><p><strong>maxRho</strong> (<em>float</em>) – maximum grid value in the free volume</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_3d</strong> (<em>numpy.ndarray([nx,ny,nz])</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.make_grid">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">make_grid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attach_xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linker_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_spacing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.make_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.make_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a 3D grid around the attachment point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>attach_xyz</strong> (<em>ndarray</em>) – one-dimensional array of x-,y-,z-coordinates of the attachment point
(corresponds to the center of the grid)</p></li>
<li><p><strong>linker_length</strong> (<em>float</em>) – length of the dye linker in Angstrom</p></li>
<li><p><strong>grid_spacing</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>grid_3d</strong> (<em>ndarray</em>) – 3-dimensional array of grid points with a shape of 2*ll_padRound+1</p></li>
<li><p><strong>xyz_min</strong> (<em>ndarray</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.setAboveTreshold">
<em class="property"><span class="pre">static</span> </em><code class="sig-name descname"><span class="pre">setAboveTreshold</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.setAboveTreshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.setAboveTreshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Reassign grid values which are above a specified treshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>treshold</strong> (<em>float</em>)</p></li>
<li><p><strong>new_value</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_3d</strong> (<em>numpy.ndarray([nx,ny,nz])</em>) – 3-dimensional array of grid points with a shape given by n_xyz</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="fretraj.grid.Grid3D.sortedNeighborIdx">
<code class="sig-name descname"><span class="pre">sortedNeighborIdx</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fretraj/grid.html#Grid3D.sortedNeighborIdx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#fretraj.grid.Grid3D.sortedNeighborIdx" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a neighbor list with a maximal extent given by maxR and sorted by increasing distance
from the origin</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>maxR</strong> (<em>float</em>) – radius within to search for neighbors</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>idxs</strong> (<em>list of 2-tuples of numpy.ndarray and float</em>) – the tuples contain the ijk indices and the distance from the origin (0,0,0)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="module_cloud.html" class="btn btn-neutral float-right" title="Cloud" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="pymol_plugin.html" class="btn btn-neutral float-left" title="PyMOL Plugin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2021, Fabio Steffen.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>